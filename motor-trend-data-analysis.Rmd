---
title: "Motor Trend Data Analysis"
author: "Jeffrey M. Hunter"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: cosmo
    keep_md: no
    df_print: paged
  pdf_document:
    toc: yes
    df_print: kable
    number_sections: false
    fig_caption: yes
    highlight: tango
    dev: pdf
  word_document:
    toc: yes
    df_print: paged
    keep_md: no
---

## Course Project

**Regression Models Course Project**

Peer-graded Assignment

* This course project is available on GitHub

    <a href="https://github.com/oraclejavanet/regression-models-course-project" target="_top">Motor Trend Data Analysis</a>

## Executive Summary

This analysis is being performed for Motor Trend, a popular American automobile
magazine, to evaluate the relationship between transmission type (manual or 
automatic) and fuel consumption in miles per gallon (MPG) in automobiles. The
analysis extends beyond transmission type to also include other possible
variables that explain variance in fuel consumption (MPG).

As part of this analysis, Motor Trend is particularly interested in the
following two questions:

* Is an automatic or manual transmission better for MPG
* Quantify the MPG difference between automatic and manual transmissions

The analysis will be conducted using exploratory data analyses and
linear regression models using the `mtcars` dataset.

## Data Description

The mtcars dataset is comprised of data that was was extracted from the
1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of
automobile design and performance for 32 automobiles (1973-74 models).

The mtcars dataset is a data frame with 32 observations on 11 (numeric)
variables:

* `mpg` Miles/(US) gallon
* `cyl` Number of cylinders
* `disp` Displacement (cu.in.)
* `hp` Gross horsepower
* `drat` Rear axle ratio
* `wt` Weight (1000 lbs)
* `qsec` 1/4 mile time
* `vs` Engine (0 = V-shaped, 1 = straight)
* `am` Transmission (0 = automatic, 1 = manual)
* `gear` Number of forward gears
* `carb` Number of carburetors

## Environment Setup

```{r setup, include = FALSE}
# set knitr options
knitr::opts_chunk$set(echo = TRUE, fig.path = 'figures/')

# clear global workspace (including hidden objects) for this session
rm(list = ls(all.names = TRUE))

# free up memory and display statistics on free memory
gc()

# disable scientific notation for numbers
options(scipen = 1)
```

```{r load-packages, message = FALSE, echo = TRUE}
if (!require(knitr)) {
    install.packages("knitr")
    library(knitr)
}
if (!require(kableExtra)) {
    install.packages("kableExtra")
    library(kableExtra)
}
if (!require(ggplot2)) {
    install.packages("ggplot2")
    library(ggplot2)
}
if (!require(GGally)) {
    install.packages("GGally")
    library(GGally)
}
```

## Load Data

Load the mtcars dataset and display the internal structure of the variables.

```{r load-data, echo = TRUE}
library(datasets)
data(mtcars)
str(mtcars)
```

## Exploratory Data Analysis

Perform some basic exploratory data analysis of the data to study the
relationship between transmission type (manual or automatic) and automobile fuel
consumption in miles per gallon (MPG).

### Basic Data Summary

The mtcars dataset includes 1 target variable (mpg) and 10 independent control
variables with 32 observations.

See [A.1 Basic Data Summary](#a.1-basic-data-summary) in the Appendix section
which shows the range and quartiles for each variable.

### Relative Mean

Display the relative mean of automobile fuel consumption data grouped by
transmission type.

```{r exploratory-data-analysis-relative-mean, echo = TRUE}
by(data = mtcars$mpg,
   INDICES = list(factor(mtcars$am, labels = c("Automatic", "Manual"))),
   summary)
```

### Impact of Transmission Type on Fuel Consumption

[Figure A.2.1 (Boxplot)](#figure-a.2.1-boxplot) and
[Figure A.2.2 (Histogram)](#figure-a.2.2-histogram) in the Appendix section
plot the relationship between transmission type and automobile fuel consumption.

### Correlation Table

```{r correlation-table, echo = TRUE}
round(cor(mtcars, method = "pearson")[1,], 2)
```

### Observation

This basic exploratory data analysis allows us to answer the initial question
on whether an automatic or manual transmission is better for fuel consumption
(MPG) in automobiles. The calculated mean for both transmission types and the
provided plots show a significant increase in better fuel consumption for
automobiles with a manual transmission versus automatic.

This analysis will extend beyond our initial interest in the relationship
between the two parameters (transmission type and fuel consumption) to include
other possible variables that explain variance in fuel consumption (MPG).
This will be performed in the remaining sections.

## Inferential Statistics

Hypothesis testing will be conducted to study the impact of transmission type on
automobile fuel consumption. A t-test will be performed on the null
hypothesis that transmission type has no effect on automobile fuel consumption.

```{r inferential-statistics-test-1, echo = TRUE}
t1 <- t.test(mpg ~ am, data = mtcars, conf.level = 0.95)
paste0("p-value = ", round(t1$p.value, 4))
paste0("confidence interval = (",
       round(t1$conf.int[1], 4),
       ", ",
       round(t1$conf.int[2], 4), ")")
t1$estimate
```

**Observation**

The observed p-value `r round(t1$p.value, 4)` is less than 0.05 and the 95%
confidence interval does not contain zero. This indicates strong evidence
against the null hypothesis so the null hypothesis can be rejected.

Assuming that the transmission data has a normal distribution, we can infer
that the difference between mean fuel consumption (MPG) of automatic and 
manual transmission is significantly different where the estimated difference
favors manual transmissions automobiles by
**`r round(t1$estimate[2] - t1$estimate[1], 4)` MPG**.

## Linear Models

Perform tests to 

This analysis will extend beyond our initial interest in the relationship
between the two parameters (transmission type and fuel consumption) to include
other possible variables that explain variance in fuel consumption (MPG). This
will be performed in the remaining sections.

### Simple Linear Regression Model



Here we try to build a linear model between the outcome mpg and the predictor am.


*Pending*

## Analysis of Residuals

*Pending*

## Conclusion

This analysis concludes the following:

1. Automobiles with a manual transmission yield better gas mileage than vehicles
   with an automatic transmission. An automobile with a manual transmission
   will achieve 17.1 MPG on average compared to 24.4 MPG for an automatic
   transmission giving us a mean difference of 7.2 MPG favoring a manual
   transmission.

1. Further analysis was performed beyond our initial interest in the
   relationship between the two parameters (transmission type and fuel
   consumption) to include other possible variables that explain variance in
   fuel consumption. This analysis showed the following correlation:
   
   a. C1
   b. C2
   c. C3

## Appendix

### A.1 Basic Data Summary

Provide a basic summary of the data.

```{r appendix-basic-data-summary, echo = TRUE, results = 'hold'}
# target variable
kable(summary(mtcars[1]),
              row.names = FALSE,
              align = c("l"),
              caption = "Target Variable (MPG)") %>%
                kable_styling(position = "center")

# independent control variables
kable(summary(mtcars[2:6]),
              row.names = FALSE,
              align = c(rep("l", 5)),
              caption = "Control Variables") %>%
                kable_styling(position = "left")

kable(summary(mtcars[7:11]),
              row.names = FALSE,
              align = rep('l', 5),
              caption = "Control Variables (cont)") %>%
                kable_styling(position = "left")
```

### A.2 Plot Impact of Transmission Type on Fuel Consumption

Plot the relationship of automobile fuel consumption as a function of
transmission type.

#### Figure A.2.1 (Boxplot)

```{r exploratory-data-analysis-mpg-on-trans-type-bp, echo = TRUE}
g <- ggplot(data = mtcars, aes(x = factor(am, labels = c("Automatic", "Manual")),
                               y = mpg, fill = factor(am, labels = c("Automatic", "Manual"))))
g <- g + geom_boxplot()
g <- g + scale_colour_discrete(name = "Transmission Type")
g <- g + scale_fill_discrete(name = "Transmission Type")
g <- g + xlab("Transmission Type")
g <- g + ylab("Fuel Consumption (MPG)")
g <- g + theme(plot.title = element_text(size = 14,
                                         hjust = 0.5,
                                         vjust = 0.5,
                                         margin = margin(b = 12, unit = "pt")),
           axis.text.x = element_text(angle = 0,
                                      hjust = 0.5,
                                      vjust = 0.5,
                                      margin = margin(b = 10, unit = "pt")),
           axis.text.y = element_text(angle = 0,
                                      hjust = 0.5,
                                      vjust = 0.5,
                                      margin = margin(l = 10, unit = "pt")))
g <- g + ggtitle("Impact of Transmission Type on Fuel Consumption")
print(g)
```

#### Figure A.2.2 (Histogram)

```{r exploratory-data-analysis-mpg-on-trans-type-hist, echo = TRUE}
g <- ggplot(data = mtcars, aes(x = mpg, y = ..count..))
g <- g + geom_histogram(binwidth = 0.75, aes(fill = factor(am, labels = c("Automatic", "Manual"))))
g <- g + facet_grid(. ~ factor(am, labels = c("Automatic", "Manual")))
g <- g + scale_colour_discrete(name = "Transmission Type")
g <- g + scale_fill_discrete(name = "Transmission Type")
g <- g + xlab("Fuel Consumption (MPG)")
g <- g + ylab("Frequency")
g <- g + theme(plot.title = element_text(size = 14,
                                         hjust = 0.5,
                                         vjust = 0.5,
                                         margin = margin(b = 12, unit = "pt")),
           axis.text.x = element_text(angle = 0,
                                      hjust = 0.5,
                                      vjust = 0.5,
                                      margin = margin(b = 10, unit = "pt")),
           axis.text.y = element_text(angle = 0,
                                      hjust = 0.5,
                                      vjust = 0.5,
                                      margin = margin(l = 10, unit = "pt")))
g <- g + ggtitle("Impact of Transmission Type on Fuel Consumption")
print(g)
```

### A.3 Figure 2

```{r figure-2, echo = TRUE}
ggcorr(data = mtcars,
       method = c("pairwise", "pearson"),
       nbreaks=8,
       palette='RdGy',
       label=TRUE,
       label_size=5,
       label_color='white')
```







